<!DOCTYPE html>




<html class="theme-next pisces" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#fff">

<link rel="preload" href="https://cdn.jsdelivr.net/gh/colorfulWorld/cdn-bed/fonts/Candyshop.otf" as="font" type="font/otf" crossorigin="anonymous">








<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />













  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">








  

<link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css" />



  

<link href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.0.74" rel="stylesheet" type="text/css" />

  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png?v=0.0.74">


  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico?v=0.0.74">


  <link rel="mask-icon" href="/safari-pinned-tab.svg?v=0.0.74" color="#fff">


  <link rel="manifest" href="/manifest.json">





  <meta name="keywords" content="colorfulWorld,blog" />





  <link rel="alternate" href="/atom.xml" title="ColorfulWorld" type="application/atom+xml" />






<meta name="description" content="Node.js å¯¹å‰ç«¯æ¥è¯´æ— ç–‘å…·æœ‰é‡Œç¨‹ç¢‘æ„ä¹‰ï¼Œå°¤å…¶æ˜¯åœ¨è¶Šæ¥è¶Šæµè¡Œçš„ä»Šå¤©ï¼ŒæŒæ¡ Node.js æŠ€æœ¯å·²ç»ä¸ä»…ä»…æ˜¯åŠ åˆ†é¡¹ï¼Œè€Œæ˜¯å‰ç«¯æ”»åŸå¸ˆä»¬éœ€è¦å»æŒæ¡çš„ä¸€é¡¹æŠ€èƒ½ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="nodeä¸­é—´å±‚åŠç®€å•apiç¼–å†™">
<meta property="og:url" content="https://colorfulworld.github.io/node%E4%B8%AD%E9%97%B4%E5%B1%82%E5%8F%8A%E7%AE%80%E5%8D%95api%E7%BC%96%E5%86%99/index.html">
<meta property="og:site_name" content="ColorfulWorld">
<meta property="og:description" content="Node.js å¯¹å‰ç«¯æ¥è¯´æ— ç–‘å…·æœ‰é‡Œç¨‹ç¢‘æ„ä¹‰ï¼Œå°¤å…¶æ˜¯åœ¨è¶Šæ¥è¶Šæµè¡Œçš„ä»Šå¤©ï¼ŒæŒæ¡ Node.js æŠ€æœ¯å·²ç»ä¸ä»…ä»…æ˜¯åŠ åˆ†é¡¹ï¼Œè€Œæ˜¯å‰ç«¯æ”»åŸå¸ˆä»¬éœ€è¦å»æŒæ¡çš„ä¸€é¡¹æŠ€èƒ½ã€‚">
<meta property="og:locale">
<meta property="og:image" content="https://colorfulworld.github.io/images/common/bff.png">
<meta property="og:image" content="https://colorfulworld.github.io/images/common/bff-1.jpeg">
<meta property="og:image" content="https://colorfulworld.github.io/images/common/bff-2.jpeg">
<meta property="article:published_time" content="2021-04-20T06:49:27.000Z">
<meta property="article:modified_time" content="2021-04-24T15:38:16.548Z">
<meta property="article:author" content="ColorfulWorld">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://colorfulworld.github.io/images/common/bff.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Pisces',
    version: '0.0.74',
    sidebar: {"position":"right","display":"always","offset":52,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    since: '6/21/2016 11:30:00',
    site: {
      title: '',
      subtitle: '',
      author: ''
    },
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    leancloud: {
      enable: false,
      appID: '',
      appKey: ''
    },
    favicon: {
      visibilitychange: true,
      narmal: '/favicon.ico',
      hidden: '/failure.ico',
      show_text: '(/â‰§â–½â‰¦/)å’¦ï¼åˆå¥½äº†ï¼',
      hide_text: '(â—â€”â—)å–”å“Ÿï¼Œå´©æºƒå•¦ï¼'
    }
  };
</script>




  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>

  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/disqusjs@1.2.2/dist/disqus.js"></script>




  <link rel="canonical" href="https://colorfulWorld.github.io/nodeä¸­é—´å±‚åŠç®€å•apiç¼–å†™/"/>





  <title>nodeä¸­é—´å±‚åŠç®€å•apiç¼–å†™ | ColorfulWorld</title>
  








<meta name="generator" content="Hexo 5.4.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans" class="theme-darling">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-é¦–é¡µ">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fas fa-meteor"></i> <br />
            
            é¦–é¡µ
          </a>
          
        </li>
      
        
        <li class="menu-item menu-item-å½’æ¡£">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fas fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
          
        </li>
      
        
        <li class="menu-item menu-item-åˆ†ç±»">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fas fa-calendar"></i> <br />
            
            åˆ†ç±»
          </a>
          
        </li>
      

      
      <li class="menu-item search">
          <form class="search-form">
            <input name="keyword" type="text" class="search-input" placeholder="ç«™å†…æœç´¢">
            <button type="submit" class="search-submit"><i class="fas fa-search"></i></button>
          </form>
      </li>
    </ul>
  

  
</nav>

<div class="site-brand-wrapper">
  <div class="site-brand-bg">
    <picture>
      <img loading="lazy" src="https://cdn.jsdelivr.net/gh/colorfulWorld/cdn-bed@1.3/images/githubpage-bg.jpg">
    </picture>
  </div>
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <div class="brand">
        <span class="logo-line-before"><i></i></span>
        <div class="site-title">
          <div id="animate-stroke" class="animate">
            <span>
                  <svg>
                    <use xlink:href="#strokeC"></use>
                  </svg>
                </span><span>
                  <svg>
                    <use xlink:href="#strokeo"></use>
                  </svg>
                </span><span>
                  <svg>
                    <use xlink:href="#strokel"></use>
                  </svg>
                </span><span>
                  <svg>
                    <use xlink:href="#strokeo"></use>
                  </svg>
                </span><span>
                  <svg>
                    <use xlink:href="#stroker"></use>
                  </svg>
                </span><span>
                  <svg>
                    <use xlink:href="#strokef"></use>
                  </svg>
                </span><span>
                  <svg>
                    <use xlink:href="#strokeu"></use>
                  </svg>
                </span><span>
                  <svg>
                    <use xlink:href="#strokel"></use>
                  </svg>
                </span><span>
                  <svg>
                    <use xlink:href="#strokeW"></use>
                  </svg>
                </span><span>
                  <svg>
                    <use xlink:href="#strokeo"></use>
                  </svg>
                </span><span>
                  <svg>
                    <use xlink:href="#stroker"></use>
                  </svg>
                </span><span>
                  <svg>
                    <use xlink:href="#strokel"></use>
                  </svg>
                </span><span>
                  <svg>
                    <use xlink:href="#stroked"></use>
                  </svg>
                </span>
          </div>
          <div id="animate" class="animate">
            <span>
                  <svg>
                    <text id="strokeC">C</text>
                  </svg>
                </span><span>
                  <svg>
                    <text id="strokeo">o</text>
                  </svg>
                </span><span>
                  <svg>
                    <text id="strokel">l</text>
                  </svg>
                </span><span>
                  <svg>
                    <text id="strokeo">o</text>
                  </svg>
                </span><span>
                  <svg>
                    <text id="stroker">r</text>
                  </svg>
                </span><span>
                  <svg>
                    <text id="strokef">f</text>
                  </svg>
                </span><span>
                  <svg>
                    <text id="strokeu">u</text>
                  </svg>
                </span><span>
                  <svg>
                    <text id="strokel">l</text>
                  </svg>
                </span><span>
                  <svg>
                    <text id="strokeW">W</text>
                  </svg>
                </span><span>
                  <svg>
                    <text id="strokeo">o</text>
                  </svg>
                </span><span>
                  <svg>
                    <text id="stroker">r</text>
                  </svg>
                </span><span>
                  <svg>
                    <text id="strokel">l</text>
                  </svg>
                </span><span>
                  <svg>
                    <text id="stroked">d</text>
                  </svg>
                </span>
          </div>
          <div id="guide" class="guide">
            <span>C</span><span>o</span><span>l</span><span>o</span><span>r</span><span>f</span><span>u</span><span>l</span><span>W</span><span>o</span><span>r</span><span>l</span><span>d</span>
          </div>
        </div>
        <span class="logo-line-after"><i></i></span>
      </div>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>
<div class="site-master" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-master-avatar scaleup" itemprop="image" src="https://cdn.jsdelivr.net/gh/colorfulWorld/cdn-bed@1.1/images/small-avatar.jpg" alt="network" />
    <h2 class="site-master-description scaleup" itemprop="description">
        ä¸è´Ÿæ‰€çˆ±
    </h2>
</div>


 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-date">
			<div class="post-month">04æœˆ</div>
			<div class="post-day">20</div>
	</div>
  
  <div class="post-badge">
    
      <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/categories/Node/" itemprop="url" rel="index">
          <span itemprop="name">Node</span>
        </a>
      </span>
    
  </div>
  

  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://colorfulWorld.github.io/node%E4%B8%AD%E9%97%B4%E5%B1%82%E5%8F%8A%E7%AE%80%E5%8D%95api%E7%BC%96%E5%86%99/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://cdn.jsdelivr.net/gh/colorfulWorld/cdn-bed@1.1/images/small-avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ColorfulWorld">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">nodeä¸­é—´å±‚åŠç®€å•apiç¼–å†™</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2021-04-20T14:49:27+08:00">2021-04-20</time>
            

            

            
          </span>

          
            <span class="post-wordcount">
              
                
                  <span class="post-meta-divider">â€¢</span>
                
                <span class="post-meta-item-icon">
                  <i class="far fa-file-word"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">5474</span>
              

              

              
            </span>
          

          
            
          

          
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
      <div class="post-toc-content"><div class="post-toc-title">æ–‡ç« ç›®å½•</div><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Node-js-%E6%98%AF%E4%BB%80%E4%B9%88"><span class="nav-text">Node.js æ˜¯ä»€ä¹ˆ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Node-js-%E4%BC%98%E5%8A%BF"><span class="nav-text">Node.js ä¼˜åŠ¿</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Node-js-%E7%89%B9%E7%82%B9"><span class="nav-text">Node.js ç‰¹ç‚¹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Node-js-%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B"><span class="nav-text">Node.js åº”ç”¨å®ä¾‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Express-%E7%AE%80%E4%BB%8B"><span class="nav-text">Express ç®€ä»‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Node-%E7%AE%80%E5%8D%95%E7%9A%84-api-%E7%BC%96%E5%86%99"><span class="nav-text">Node ç®€å•çš„ api ç¼–å†™</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">å‰è¨€</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%8D%E7%AB%AF%E9%83%A8%E5%88%86"><span class="nav-text">å‰ç«¯éƒ¨åˆ†</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="nav-text">ç›®å½•ç»“æ„</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL-%E4%B8%8E-Navicat"><span class="nav-text">MySQL ä¸ Navicat</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E9%83%A8%E5%88%86"><span class="nav-text">æ•°æ®åº“è®¾è®¡éƒ¨åˆ†</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8E%E7%AB%AF%E9%83%A8%E5%88%86"><span class="nav-text">åç«¯éƒ¨åˆ†</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84-1"><span class="nav-text">ç›®å½•ç»“æ„</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8A%80%E6%9C%AF%E6%A0%88"><span class="nav-text">æŠ€æœ¯æ ˆ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97"><span class="nav-text">åŠŸèƒ½æ¨¡å—</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="nav-text">ä»£ç å®ç°</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-BFF"><span class="nav-text">ä»€ä¹ˆæ˜¯ BFF</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%80%89%E6%8B%A9-Node-%E4%BD%9C%E4%B8%BA%E4%B8%AD%E9%97%B4%E5%B1%82"><span class="nav-text">ä¸ºä»€ä¹ˆé€‰æ‹© Node ä½œä¸ºä¸­é—´å±‚</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%9A%E5%8A%A1%E9%A9%B1%E5%8A%A8"><span class="nav-text">ä¸šåŠ¡é©±åŠ¨</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%B6%E6%9E%84%E9%9C%80%E8%A6%81"><span class="nav-text">æ¶æ„éœ€è¦</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%A7%E8%83%BD%E6%BB%A1%E8%B6%B3"><span class="nav-text">æ€§èƒ½æ»¡è¶³</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%88%90%E6%9C%AC%E8%BE%83%E4%BD%8E"><span class="nav-text">æˆæœ¬è¾ƒä½</span></a></li></ol></li></ol></li></ol></div>
      
      

      
        <p>Node.js å¯¹å‰ç«¯æ¥è¯´æ— ç–‘å…·æœ‰é‡Œç¨‹ç¢‘æ„ä¹‰ï¼Œå°¤å…¶æ˜¯åœ¨è¶Šæ¥è¶Šæµè¡Œçš„ä»Šå¤©ï¼ŒæŒæ¡ Node.js æŠ€æœ¯å·²ç»ä¸ä»…ä»…æ˜¯åŠ åˆ†é¡¹ï¼Œè€Œæ˜¯å‰ç«¯æ”»åŸå¸ˆä»¬éœ€è¦å»æŒæ¡çš„ä¸€é¡¹æŠ€èƒ½ã€‚</p>
<span id="more"></span>

<h2 id="Node-js-æ˜¯ä»€ä¹ˆ"><a href="#Node-js-æ˜¯ä»€ä¹ˆ" class="headerlink" title="Node.js æ˜¯ä»€ä¹ˆ"></a>Node.js æ˜¯ä»€ä¹ˆ</h2><p>ç®€å•çš„è¯´ Node.js å°±æ˜¯ä¸€ä¸ª javascript è¿è¡Œç¯å¢ƒã€‚å®ƒè®© javascript å¯ä»¥å¼€å‘åç«¯ç¨‹åºï¼Œå®ç°å‡ ä¹å…¶ä»–åç«¯è¯­è¨€å®ç°çš„æ‰€æœ‰åŠŸèƒ½ï¼Œå¯ä»¥ä¸ PHPã€Javaã€Pythonã€.NETã€Ruby ç­‰åç«¯è¯­è¨€ä¸€è¾ƒé«˜ä¸‹ã€‚</p>
<p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome JavaScript è¿è¡Œæ—¶å»ºç«‹çš„ä¸€ä¸ªå¹³å°ã€‚</p>
<p>Node.js æ˜¯ä¸€ä¸ªäº‹ä»¶é©±åŠ¨ I/O æœåŠ¡ç«¯ JavaScript ç¯å¢ƒï¼ŒåŸºäº Google çš„ V8 å¼•æ“ï¼ŒV8 å¼•æ“æ‰§è¡Œ Javascript çš„é€Ÿåº¦éå¸¸å¿«ï¼Œæ€§èƒ½éå¸¸å¥½ã€‚<br><code>Node.js = Runtime Environment + JavaScript Library</code></p>
<h2 id="Node-js-ä¼˜åŠ¿"><a href="#Node-js-ä¼˜åŠ¿" class="headerlink" title="Node.js ä¼˜åŠ¿"></a>Node.js ä¼˜åŠ¿</h2><ul>
<li><p><strong>Nodejs è¯­æ³•å®Œå…¨æ˜¯ js è¯­æ³•</strong><br>åªè¦ä½ æ‡‚ js åŸºç¡€å°±å¯ä»¥å­¦ä¼š Nodejs åç«¯å¼€å‘ï¼Œå¯¹å‰ç«¯å¼€å‘è€…å‹å¥½ã€‚</p>
</li>
<li><p><strong>NodeJs è¶…å¼ºçš„é«˜å¹¶å‘èƒ½åŠ›</strong><br>æ”¾å¼ƒäº†â€œä¸ºæ¯ä¸€ä¸ªç”¨æˆ·è¿æ¥åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹â€çš„æ€æƒ³ï¼Œé€šè¿‡éé˜»å¡ I/Oã€äº‹ä»¶é©±åŠ¨æœºåˆ¶ï¼Œè®© Node.js ç¨‹åºå®è§‚ä¸Šä¹Ÿæ˜¯å¹¶è¡Œçš„ã€‚</p>
</li>
<li><p><strong>å®ç°é«˜æ€§èƒ½æœåŠ¡å™¨</strong><br>ä¸¥æ ¼åœ°è¯´ï¼ŒNode.js æ˜¯ä¸€ä¸ªç”¨äºå¼€å‘å„ç§ web æœåŠ¡å™¨çš„å¼€å‘å·¥å…·ã€‚åœ¨ Node.js æœåŠ¡å™¨ä¸­ï¼Œè¿è¡Œçš„æ˜¯é«˜æ€§èƒ½ V8 JavaScript è„šæœ¬è¯­è¨€ï¼Œè¯¥è¯­è¨€æ˜¯ä¸€ç§å¯ä»¥è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„è„šæœ¬è¯­è¨€ã€‚</p>
<p>Node.js è‡ªèº«å“²å­¦ï¼Œæ˜¯è¯æœ€å°çš„ç¡¬ä»¶æˆæœ¬ï¼Œè¿½æ±‚æ›´é«˜çš„å¹¶å‘ï¼Œæ›´é«˜çš„å¤„ç†æ€§èƒ½ã€‚</p>
</li>
</ul>
<h2 id="Node-js-ç‰¹ç‚¹"><a href="#Node-js-ç‰¹ç‚¹" class="headerlink" title="Node.js ç‰¹ç‚¹"></a>Node.js ç‰¹ç‚¹</h2><p>å¼‚æ­¥äº‹ä»¶é©±åŠ¨ã€éå µå¡ I/O</p>
<ul>
<li><p><strong>Node.js ä½¿ç”¨äº‹ä»¶é©±åŠ¨æ¨¡å‹ï¼Œå½“ web server æ¥æ”¶åˆ°è¯·æ±‚ï¼Œå°±æŠŠå®ƒå…³é—­ç„¶åè¿›è¡Œå¤„ç†ï¼Œç„¶åå»æœåŠ¡ä¸‹ä¸€ä¸ª web è¯·æ±‚ã€‚</strong><br>å½“è¿™ä¸ªè¯·æ±‚å®Œæˆï¼Œå®ƒè¢«æ”¾å›å¤„ç†é˜Ÿåˆ—ï¼Œå½“åˆ°è¾¾é˜Ÿåˆ—å¼€å¤´ï¼Œè¿™ä¸ªç»“æœè¢«è¿”å›ç»™ç”¨æˆ·ã€‚<br>è¿™ä¸ªæ¨¡å‹éå¸¸é«˜æ•ˆå¯æ‰©å±•æ€§éå¸¸å¼ºï¼Œå› ä¸º webserver ä¸€ç›´æ¥å—è¯·æ±‚è€Œä¸ç­‰å¾…ä»»ä½•è¯»å†™æ“ä½œã€‚è¿™ä¸ªæ¨¡å‹éå¸¸é«˜æ•ˆå¯æ‰©å±•æ€§éå¸¸å¼ºï¼Œå› ä¸º webserver ä¸€ç›´æ¥å—è¯·æ±‚è€Œä¸ç­‰å¾…ä»»ä½•è¯»å†™æ“ä½œã€‚ï¼ˆè¿™ä¹Ÿè¢«ç§°ä¹‹ä¸ºéé˜»å¡å¼ IO æˆ–è€…äº‹ä»¶é©±åŠ¨ IOï¼‰</p>
<p>åœ¨äº‹ä»¶é©±åŠ¨æ¨¡å‹ä¸­ï¼Œä¼šç”Ÿæˆä¸€ä¸ªä¸»å¾ªç¯æ¥ç›‘å¬äº‹ä»¶ï¼Œå½“æ£€æµ‹åˆ°äº‹ä»¶æ—¶è§¦å‘å›è°ƒå‡½æ•°</p>
</li>
<li><p><strong>å•çº¿ç¨‹</strong></p>
<p>Nodejs è·Ÿ Nginx ä¸€æ ·éƒ½æ˜¯å•çº¿ç¨‹ä¸ºåŸºç¡€çš„ï¼Œè¿™é‡Œçš„å•çº¿ç¨‹æŒ‡ä¸»çº¿ç¨‹ä¸ºå•çº¿ç¨‹ï¼Œæ‰€æœ‰çš„é˜»å¡çš„å…¨éƒ¨æ”¾å…¥ä¸€ä¸ªçº¿ç¨‹æ± ä¸­ï¼Œç„¶åä¸»çº¿ç¨‹é€šè¿‡é˜Ÿåˆ—çš„æ–¹å¼è·Ÿçº¿ç¨‹æ± æ¥åä½œã€‚æˆ‘ä»¬å†™ js éƒ¨åˆ†ä¸éœ€è¦å…³å¿ƒçº¿ç¨‹çš„é—®é¢˜ï¼Œç®€å•äº†è§£å°±å¯ä»¥äº†ï¼Œä¸»è¦ç”±ä¸€å † callback å›è°ƒæ„æˆçš„ï¼Œç„¶åä¸»çº¿ç¨‹åœ¨å¾ªç¯è¿‡åœ¨é€‚å½“åœºåˆè°ƒç”¨ã€‚</p>
</li>
<li><p><strong>æ€§èƒ½å‡ºä¼—</strong></p>
<p>åº•å±‚é€‰æ‹©ç”¨ c++å’Œ v8 æ¥å®ç°çš„ï¼Œä¸Šé¢ç¬¬ä¸€ç‚¹è®²åˆ°è¿‡ï¼Œnodejs çš„äº‹ä»¶é©±åŠ¨æœºåˆ¶ï¼Œè¿™æ„å‘³ç€é¢å¯¹å¤§è§„æ¨¡çš„ http è¯·æ±‚ï¼Œnodejs æ˜¯å‡­å€Ÿäº‹ä»¶é©±åŠ¨æ¥å®Œæˆçš„ï¼Œæ€§èƒ½éƒ¨åˆ†æ˜¯ä¸ç”¨æ‹…å¿ƒçš„ï¼Œå¹¶ä¸”å¾ˆå‡ºè‰²ã€‚</p>
</li>
</ul>
<h2 id="Node-js-åº”ç”¨å®ä¾‹"><a href="#Node-js-åº”ç”¨å®ä¾‹" class="headerlink" title="Node.js åº”ç”¨å®ä¾‹"></a>Node.js åº”ç”¨å®ä¾‹</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> hostname = <span class="string">&#x27;127.0.0.1&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> port = <span class="number">3000</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http.createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.statusCode = <span class="number">200</span>;</span><br><span class="line">  res.setHeader(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;text/plain&#x27;</span>);</span><br><span class="line">  res.end(<span class="string">&#x27;Hello World&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(port, hostname, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Server running at http://<span class="subst">$&#123;hostname&#125;</span>:<span class="subst">$&#123;port&#125;</span>/`</span>);</span><br></pre></td></tr></table></figure>

<h2 id="Express-ç®€ä»‹"><a href="#Express-ç®€ä»‹" class="headerlink" title="Express ç®€ä»‹"></a>Express ç®€ä»‹</h2><p>Express æ˜¯ä¸€ä¸ªç®€æ´è€Œçµæ´»çš„ node.js Web åº”ç”¨æ¡†æ¶, æä¾›äº†ä¸€ç³»åˆ—å¼ºå¤§ç‰¹æ€§å¸®åŠ©ä½ åˆ›å»ºå„ç§ Web åº”ç”¨ï¼Œå’Œä¸°å¯Œçš„ HTTP å·¥å…·ã€‚</p>
<p>ä½¿ç”¨ Express å¯ä»¥å¿«é€Ÿåœ°æ­å»ºä¸€ä¸ªå®Œæ•´åŠŸèƒ½çš„ç½‘ç«™ã€‚</p>
<p>Express æ¡†æ¶æ ¸å¿ƒç‰¹æ€§ï¼š</p>
<ul>
<li>å¯ä»¥è®¾ç½®ä¸­é—´ä»¶æ¥å“åº” HTTP è¯·æ±‚ã€‚</li>
<li>å®šä¹‰äº†è·¯ç”±è¡¨ç”¨äºæ‰§è¡Œä¸åŒçš„ HTTP è¯·æ±‚åŠ¨ä½œã€‚</li>
<li>å¯ä»¥é€šè¿‡å‘æ¨¡æ¿ä¼ é€’å‚æ•°æ¥åŠ¨æ€æ¸²æŸ“ HTML é¡µé¢ã€‚</li>
<li>ä»‹ç»å°±å…ˆå‘Šä¸€æ®µè½äº†ï¼Œæ¥ä¸‹æ¥é€šè¿‡ä¸€ä¸ªé¡¹ç›®å®ä¾‹æ¥è¿›è¡Œ node æ­å»ºæœåŠ¡çš„è®²è§£</li>
</ul>
<h2 id="Node-ç®€å•çš„-api-ç¼–å†™"><a href="#Node-ç®€å•çš„-api-ç¼–å†™" class="headerlink" title="Node ç®€å•çš„ api ç¼–å†™"></a>Node ç®€å•çš„ api ç¼–å†™</h2><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>æ­¤ç« èŠ‚é‡‡ç”¨é¡¹ç›®å®ä¾‹ç›´æ¥æ¼”ç¤ºå¦‚ä½•å®ç°ç®€å• API çš„ç¼–å†™ã€‚å‰ç«¯é¡¹ç›®é‡‡ç”¨çš„æŠ€æœ¯æ ˆæ˜¯åŸºäº Vue + Antdvï¼Œç”¨ vue-cli æ„å»ºå‰ç«¯ç•Œé¢ï¼Œåç«¯é¡¹ç›®é‡‡ç”¨çš„æŠ€æœ¯æ ˆæ˜¯åŸºäº Node.js + Express + MySQLï¼Œç”¨ Express æ­å»ºçš„åç«¯æœåŠ¡å™¨ã€‚</p>
<h3 id="å‰ç«¯éƒ¨åˆ†"><a href="#å‰ç«¯éƒ¨åˆ†" class="headerlink" title="å‰ç«¯éƒ¨åˆ†"></a>å‰ç«¯éƒ¨åˆ†</h3><p>ä½¿ç”¨ Vue + antdvï¼Œç”¨ vue-cli æ„å»ºå‰ç«¯é¡¹ç›®</p>
<h4 id="ç›®å½•ç»“æ„"><a href="#ç›®å½•ç»“æ„" class="headerlink" title="ç›®å½•ç»“æ„"></a>ç›®å½•ç»“æ„</h4><figure class="highlight m"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">â”‚ package.json // npm åŒ…ç®¡ç†æ‰€éœ€æ¨¡å—åŠé…ç½®ä¿¡æ¯</span><br><span class="line">â”‚ vue.config.js // webpack é…ç½®</span><br><span class="line">â”œâ”€public</span><br><span class="line">â”‚ favicon.ico // å›¾æ ‡</span><br><span class="line">â”‚ index.html // å…¥å£ html æ–‡ä»¶</span><br><span class="line">â””â”€src</span><br><span class="line">â”‚ App.vue // æ ¹ç»„ä»¶</span><br><span class="line">â”‚ main.js // ç¨‹åºå…¥å£æ–‡ä»¶</span><br><span class="line">â”‚ permission.js // æƒé™æ‹¦æˆª</span><br><span class="line">â”‚ globla.less // å…¨å±€æ ·å¼</span><br><span class="line">â”œâ”€api</span><br><span class="line">â”‚ task.js // ä»»åŠ¡æ¨¡å—æ¥å£</span><br><span class="line">â”‚ user.js // ç”¨æˆ·æ¨¡å—æ¥å£</span><br><span class="line">â”œâ”€assets // å­˜æ”¾å…¬å…±å›¾ç‰‡æ–‡ä»¶å¤¹</span><br><span class="line">â”œâ”€components</span><br><span class="line">â”‚ ProLayout // Pro å¸ƒå±€ç»„å»º</span><br><span class="line">â”œâ”€layouts</span><br><span class="line">â”‚ index.js // å¸ƒå±€æ•´åˆ</span><br><span class="line">â”‚ UserLayout.vue // ç”¨æˆ·å¸ƒå±€</span><br><span class="line">â”‚ BasicLayout.vue // åŸºæœ¬å¸ƒå±€</span><br><span class="line">â”œâ”€core</span><br><span class="line">â”‚ lazy_use.js // æ‡’åŠ è½½ä½¿ç”¨çš„ antd ç­‰</span><br><span class="line">â”œâ”€router</span><br><span class="line">â”‚ index.js // å•é¡µé¢è·¯ç”±æ³¨å†Œç»„ä»¶</span><br><span class="line">â”œâ”€store</span><br><span class="line">â”‚ â”‚ index.js // çŠ¶æ€ç®¡ç†ä»“åº“å…¥å£æ–‡ä»¶</span><br><span class="line">â”‚ â”‚ getters.js // getter</span><br><span class="line">â”‚ â”‚ mutation-types.js // store ä½¿ç”¨çš„å¸¸é‡</span><br><span class="line">â”‚ â””â”€modules</span><br><span class="line">â”‚ user.js // ç”¨æˆ·æ¨¡å—çŠ¶æ€ç®¡ç†æ–‡ä»¶</span><br><span class="line">â”œâ”€utils</span><br><span class="line">â”‚ axios.js // å®‰è£… axios æ’ä»¶</span><br><span class="line">â”‚ domUtils.js // æ“ä½œé¡µç­¾ title</span><br><span class="line">â”‚ request.js // axios å°è£…ä¸æ‹¦æˆªå™¨é…ç½®</span><br><span class="line">â””â”€views</span><br><span class="line">user // ç”¨æˆ·æ¨¡å—é¡µé¢</span><br><span class="line">task // ä»»åŠ¡æ¨¡å—é¡µé¢</span><br><span class="line"><span class="number">404</span>.vue // <span class="number">404</span> é¡µé¢</span><br></pre></td></tr></table></figure>

<h3 id="MySQL-ä¸-Navicat"><a href="#MySQL-ä¸-Navicat" class="headerlink" title="MySQL ä¸ Navicat"></a>MySQL ä¸ Navicat</h3><p>MySQL æ˜¯æœ€æµè¡Œçš„å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œåœ¨ WEB åº”ç”¨æ–¹é¢ MySQL æ˜¯æœ€å¥½çš„ RDBMS(Relational Database Management Systemï¼šå…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ)åº”ç”¨è½¯ä»¶ä¹‹ä¸€ã€‚</p>
<p>Navicat premium æ˜¯ä¸€æ¬¾æ•°æ®åº“ç®¡ç†å·¥å…·,æ˜¯ä¸€ä¸ªå¯å¤šé‡è¿çº¿èµ„æ–™åº“çš„ç®¡ç†å·¥å…·ï¼Œå®ƒå¯ä»¥è®©ä½ ä»¥å•ä¸€ç¨‹å¼åŒæ—¶è¿çº¿åˆ° MySQLã€SQLiteã€Oracle åŠ PostgreSQL èµ„æ–™åº“ï¼Œè®©ç®¡ç†ä¸åŒç±»å‹çš„èµ„æ–™åº“æ›´åŠ çš„æ–¹ä¾¿ã€‚</p>
<h4 id="æ•°æ®åº“è®¾è®¡éƒ¨åˆ†"><a href="#æ•°æ®åº“è®¾è®¡éƒ¨åˆ†" class="headerlink" title="æ•°æ®åº“è®¾è®¡éƒ¨åˆ†"></a>æ•°æ®åº“è®¾è®¡éƒ¨åˆ†</h4><p>ä½¿ç”¨ MYSQLï¼Œåˆ›å»ºæ•°æ®åº“ todoï¼Œåˆ›å»º sys_user ç”¨æˆ·è¡¨åŠåˆ›å»º sys_task ä»»åŠ¡è¡¨</p>
<p>-åˆ›å»ºæ•°æ®åº“â€“</p>
<p><code>CREATE DATABASE </code>todo<code> DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;</code><br>â€“åˆ›å»ºç”¨æˆ·è¡¨â€“</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">DROP TABLE IF EXISTS <span class="string">`sys_user`</span>;</span><br><span class="line">CREATE TABLE <span class="string">`sys_user`</span> (</span><br><span class="line"><span class="string">`id`</span> BIGINT(<span class="number">20</span>) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT <span class="string">&#x27;å”¯ä¸€æ ‡è¯†&#x27;</span>,</span><br><span class="line"><span class="string">`username`</span> VARCHAR(<span class="number">50</span>) NOT NULL COMMENT <span class="string">&#x27;ç™»å½•å¸å·&#x27;</span>,</span><br><span class="line"><span class="string">`password`</span> VARCHAR(<span class="number">64</span>) NOT NULL  COMMENT <span class="string">&#x27;ç™»å½•å¯†ç &#x27;</span>,</span><br><span class="line"><span class="string">`nickname`</span> VARCHAR(<span class="number">50</span>) NULL DEFAULT <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;æ˜µç§°&#x27;</span>,</span><br><span class="line"><span class="string">`avator`</span> VARCHAR(<span class="number">50</span>) NULL DEFAULT <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;ç”¨æˆ·å¤´åƒ&#x27;</span>,</span><br><span class="line"><span class="string">`sex`</span> int(<span class="number">3</span>) NULL DEFAULT <span class="number">0</span> COMMENT <span class="string">&#x27;æ€§åˆ«ï¼š0:æœªçŸ¥, 1:ç”·, 2:å¥³&#x27;</span>,</span><br><span class="line"><span class="string">`gmt_create`</span> BIGINT(<span class="number">13</span>) NOT NULL COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line"><span class="string">`gmt_modify`</span> BIGINT(<span class="number">13</span>) NOT NULL COMMENT <span class="string">&#x27;ä¿®æ”¹æ—¶é—´&#x27;</span>,</span><br><span class="line"> PRIMARY KEY (<span class="string">`id`</span>) USING BTREE,</span><br><span class="line"> UNIQUE KEY <span class="string">`username_UNIQUE`</span> (<span class="string">`username`</span>)</span><br><span class="line">) ENGINE=InnoDB AUTO_INCREMENT=<span class="number">1</span> COMMENT=<span class="string">&#x27;ç”¨æˆ·è¡¨&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>â€“åˆ›å»ºä»»åŠ¡è¡¨â€“</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DROP TABLE IF EXISTS <span class="string">`sys_task`</span>;</span><br><span class="line">CREATE TABLE <span class="string">`sys_task`</span> (</span><br><span class="line"><span class="string">`id`</span> bigint(<span class="number">20</span>) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT <span class="string">&#x27;å”¯ä¸€æ ‡è¯†&#x27;</span>,</span><br><span class="line"><span class="string">`title`</span> varchar(<span class="number">100</span>) NOT NULL COMMENT <span class="string">&#x27;ä»»åŠ¡åç§°&#x27;</span>,</span><br><span class="line"><span class="string">`description`</span> varchar(<span class="number">255</span>) NOT NULL COMMENT <span class="string">&#x27;ä»»åŠ¡å†…å®¹&#x27;</span>,</span><br><span class="line"><span class="string">`status`</span> int(<span class="number">3</span>) NULL DEFAULT <span class="number">0</span> COMMENT <span class="string">&#x27;ä»»åŠ¡çŠ¶æ€ï¼š0:å¾…åŠ 1:å®Œæˆ 2:åˆ é™¤&#x27;</span>,</span><br><span class="line"><span class="string">`gmt_create`</span> bigint(<span class="number">13</span>) NOT NULL COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line"><span class="string">`gmt_expire`</span> bigint(<span class="number">13</span>) NOT NULL COMMENT <span class="string">&#x27;æˆªæ­¢æ—¥æœŸ&#x27;</span>,</span><br><span class="line">PRIMARY KEY (<span class="string">`id`</span>) USING BTREE</span><br><span class="line">) ENGINE=InnoDB AUTO_INCREMENT=<span class="number">1</span> COMMENT=<span class="string">&#x27;ä»»åŠ¡è¡¨&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="åç«¯éƒ¨åˆ†"><a href="#åç«¯éƒ¨åˆ†" class="headerlink" title="åç«¯éƒ¨åˆ†"></a>åç«¯éƒ¨åˆ†</h3><p>ä½¿ç”¨ Node.js + Express + MySQLï¼Œæ­å»ºçš„åç«¯æœåŠ¡å™¨ã€‚</p>
<h4 id="ç›®å½•ç»“æ„-1"><a href="#ç›®å½•ç»“æ„-1" class="headerlink" title="ç›®å½•ç»“æ„"></a>ç›®å½•ç»“æ„</h4><figure class="highlight m"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">â”‚  app.js                             // å…¥å£æ–‡ä»¶</span><br><span class="line">â”‚  package.json                       // npmåŒ…ç®¡ç†æ‰€éœ€æ¨¡å—åŠé…ç½®ä¿¡æ¯</span><br><span class="line">â”‚  bin</span><br><span class="line">â”‚      www                            // startç¨‹åºè¿è¡Œæ–‡ä»¶</span><br><span class="line">â”‚  config</span><br><span class="line">â”‚      db.js                          // mysqlæ•°æ®åº“åŸºç¡€é…ç½®</span><br><span class="line">â”œâ”€db</span><br><span class="line">â”‚      mysql.js                       // å°è£…è¿æ¥mysqlæ¨¡å—</span><br><span class="line">â”œâ”€routes</span><br><span class="line">â”‚      index.js                       // åˆå§‹åŒ–è·¯ç”±ä¿¡æ¯ï¼Œå¼•å…¥authä¸­é—´ä»¶</span><br><span class="line">â”‚      tasks.js                       // ä»»åŠ¡è·¯ç”±æ¨¡å—</span><br><span class="line">â”‚      users.js                       // ç”¨æˆ·è·¯ç”±æ¨¡å—</span><br><span class="line">â”œâ”€controllers</span><br><span class="line">â”‚      index.js                 			 // ä¸šåŠ¡é€»è¾‘å¤„ç† - å…¥å£</span><br><span class="line">â”‚      tasks.js                 			 // ä¸šåŠ¡é€»è¾‘å¤„ç† - ä»»åŠ¡ç›¸å…³æ¥å£</span><br><span class="line">â”‚      users.js                 			 // ä¸šåŠ¡é€»è¾‘å¤„ç† - ç”¨æˆ·ç›¸å…³æ¥å£</span><br><span class="line">â””â”€utils</span><br><span class="line">        constant.js                   // è‡ªå®šä¹‰å¸¸é‡</span><br><span class="line">        crypto.js                     // åŠ å¯†æ ‡å‡†å®ç°æ–¹æ³•</span><br><span class="line">        jwtAuth.js                    // jwt-tokenéªŒè¯å’Œè§£æå‡½æ•°</span><br><span class="line">        resHandler.js                 // åŒ…è£…ç»Ÿä¸€è¿”å›æ ¼å¼</span><br></pre></td></tr></table></figure>

<h4 id="æŠ€æœ¯æ ˆ"><a href="#æŠ€æœ¯æ ˆ" class="headerlink" title="æŠ€æœ¯æ ˆ"></a>æŠ€æœ¯æ ˆ</h4><p>åç«¯ç™»å½•æ³¨å†ŒåŠŸèƒ½ä½¿ç”¨äº† jwt-token è®¤è¯æ¨¡å¼æ¥å®ç°ã€‚ä½¿ç”¨ expressã€express-validatorã€jsonwebtokenã€express-jwtã€mySQL ç»„ä»¶åº“æ¥ç®€åŒ–å¼€å‘ã€‚</p>
<ul>
<li>expressï¼šæä¾›äº†åˆ›å»º Web æœåŠ¡å™¨çš„æœ€ç®€å•ä½†åŠŸèƒ½æœ€å¼ºå¤§çš„æ–¹æ³•ä¹‹ä¸€ã€‚</li>
<li>express-validatorï¼šä¸€ä¸ªåŸºäº Express çš„æ•°æ®éªŒè¯ä¸­é—´ä»¶ï¼Œå¯ä»¥æ–¹ä¾¿çš„åˆ¤æ–­ä¼ å…¥çš„è¡¨å•æ•°æ®æ˜¯å¦åˆæ³•ã€‚</li>
<li>jsonwebtokenï¼šåŸºäº jwt çš„æ¦‚å¿µå®ç°å®‰å…¨çš„åŠ å¯†æ–¹æ¡ˆåº“ï¼Œå®ç°åŠ å¯† token å’Œè§£æ token çš„åŠŸèƒ½ã€‚</li>
<li>express-jwtï¼šexpress-jwt æ˜¯åœ¨ jsonwebtoken çš„åŸºç¡€ä¸Šåšäº†ä¸Šå±‚å°è£…ï¼ŒåŸºäº Express æ¡†æ¶ä¸‹è®¤è¯ jwt çš„ä¸­é—´ä»¶ï¼Œæ¥å®ç° jwt çš„è®¤è¯åŠŸèƒ½ã€‚</li>
<li>http-errorsï¼šè½»æ¾åˆ›å»º Expressï¼ŒKoaï¼ŒConnect ç­‰çš„ HTTP é”™è¯¯ã€‚</li>
<li>mysqlï¼šNode.js è¿æ¥ MySQL æ•°æ®åº“ã€‚</li>
<li>nodemonï¼šå®ç°å®æ—¶çƒ­æ›´æ–°ï¼Œè‡ªåŠ¨é‡å¯é¡¹ç›®ã€‚</li>
</ul>
<h4 id="åŠŸèƒ½æ¨¡å—"><a href="#åŠŸèƒ½æ¨¡å—" class="headerlink" title="åŠŸèƒ½æ¨¡å—"></a>åŠŸèƒ½æ¨¡å—</h4><ul>
<li>ç”¨æˆ·æ¨¡å—ï¼šç™»å½•ã€æ³¨å†Œ</li>
<li>ä»»åŠ¡æ¨¡å—ï¼štodoList å¢åˆ æ”¹æŸ¥</li>
</ul>
<h4 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h4><ul>
<li><strong>å®‰è£…å…¨å±€ä¾èµ–</strong></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install express -g or yarn <span class="built_in">global</span> add express</span><br><span class="line">npm install express-generator -g or yarn <span class="built_in">global</span> express-generator</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>ä½¿ç”¨ express-generator ç”Ÿæˆ todo_api é¡¹ç›®</strong></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir todo_api</span><br><span class="line">cd todo_api</span><br><span class="line">express</span><br><span class="line">npm install or yarn install</span><br><span class="line">npm start or yarn start</span><br></pre></td></tr></table></figure>

<p>ç„¶åè®¿é—® localhost:3000ï¼Œæœ€ç®€å•çš„æœåŠ¡å™¨å°± ğŸ‘Œ äº†</p>
<ul>
<li><p><strong>æ·»åŠ è‡ªåŠ¨é‡å¯æœåŠ¡</strong></p>
<p>æ¯æ¬¡ä¿®æ”¹ js æ–‡ä»¶ï¼Œæˆ‘ä»¬éƒ½éœ€è¦é‡å¯æœåŠ¡å™¨ï¼Œè¿™æ ·ä¿®æ”¹çš„å†…å®¹æ‰ä¼šç”Ÿæ•ˆï¼Œä½†æ˜¯æ¯æ¬¡é‡å¯æ¯”è¾ƒéº»çƒ¦ï¼Œå½±å“å¼€å‘æ•ˆæœã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨å¼€å‘ç¯å¢ƒä¸­å¼•å…¥ nodemon æ’ä»¶ï¼Œå®ç°å®æ—¶çƒ­æ›´æ–°ï¼Œè‡ªåŠ¨é‡å¯é¡¹ç›®ã€‚</p>
</li>
</ul>
<p><code>yarn add nodemon -D</code><br>ä¿®æ”¹ package.json æ–‡ä»¶ä¸­é…ç½®çš„ start å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;start&quot;</span>: <span class="string">&quot;nodemon ./bin/www&quot;</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>å®‰è£…ç›¸å…³ä¾èµ–åº“</strong><br><code>yarn add express-validator jsonwebtoken express-jwt mysql</code><br>** ä¿®æ”¹ç›®å½•ç»“æ„**</p>
</li>
<li><p><strong>é¡¹ç›®é…ç½®æ¨¡å—ï¼ˆConfigï¼‰</strong><br>åœ¨æ ¹ç›®å½•ä¸‹ config æ–‡ä»¶å¤¹ï¼Œå¹¶æ–°å¢ db.js æ–‡ä»¶ï¼Œç”¨äº mysql æ•°æ®åº“åŸºç¡€é…ç½®</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é…ç½®</span></span><br><span class="line"><span class="keyword">const</span> MYSQL_CONF = &#123;</span><br><span class="line">  host: <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">  user: <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">  password: <span class="string">&#x27;xzh123456&#x27;</span>,</span><br><span class="line">  port: <span class="string">&#x27;3306&#x27;</span>,</span><br><span class="line">  database: <span class="string">&#x27;todo&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  MYSQL_CONF</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>æ•°æ®åº“æ¨¡å—ï¼ˆDBï¼‰</strong><br>åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»º db æ–‡ä»¶å¤¹ï¼Œå¹¶åˆ›å»º mysql.js æ–‡ä»¶ï¼Œç”¨äºå°è£…è¿æ¥ mysql æ¨¡å—</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mysql = <span class="built_in">require</span>(<span class="string">&#x27;mysql&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; MYSQL_CONF &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../config/db&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> connection = <span class="function">() =&gt;</span> mysql.createConnection(MYSQL_CONF)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> querySql = <span class="function">(<span class="params">sql</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> conn = connection()</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      conn.query(sql, <span class="function">(<span class="params">err, res</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          reject(err)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          resolve(res)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      reject(e)</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      <span class="comment">// é‡Šæ”¾è¿æ¥</span></span><br><span class="line">      conn.end()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  querySql</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>å·¥å…·æ¨¡å—ï¼ˆUtilsï¼‰</strong><br>åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»º utils æ–‡ä»¶å¤¹</li>
</ul>
<p>åˆ›å»º constant.js æ–‡ä»¶ï¼Œç”¨äºè‡ªå®šä¹‰å¸¸é‡</p>
<p>ä»£ç å¦‚ä¸‹</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  CODE_ERROR: <span class="string">&quot;9999&quot;</span>, <span class="comment">// è¯·æ±‚å“åº”å¤±è´¥codeç </span></span><br><span class="line">  CODE_SUCCESS: <span class="string">&quot;0000&quot;</span>, <span class="comment">// è¯·æ±‚å“åº”æˆåŠŸcodeç </span></span><br><span class="line">  PRIVATE_KEY: <span class="string">&quot;todo&quot;</span>, <span class="comment">// è‡ªå®šä¹‰jwtåŠ å¯†çš„ç§é’¥</span></span><br><span class="line">  JWT_EXPIRED: <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span>, <span class="comment">// è¿‡æœŸæ—¶é—´24å°æ—¶</span></span><br><span class="line">&#125;;</span><br><span class="line">åˆ›å»ºcrypto.jsæ–‡ä»¶ï¼Œç”¨äºåŠ å¯†æ ‡å‡†å®ç°æ–¹æ³•</span><br></pre></td></tr></table></figure>

<p>ä»£ç å¦‚ä¸‹</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>) <span class="comment">// å¼•å…¥cryptoåŠ å¯†æ¨¡å—</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> md5 = <span class="function">(<span class="params">v</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> crypto</span><br><span class="line">    .createHash(<span class="string">&#x27;md5&#x27;</span>)</span><br><span class="line">    .update(<span class="string">&#x27;&#x27;</span> + v)</span><br><span class="line">    .digest(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  md5</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>) <span class="comment">// å¼•å…¥cryptoåŠ å¯†æ¨¡å—</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> md5 = <span class="function">(<span class="params">v</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> crypto</span><br><span class="line">    .createHash(<span class="string">&#x27;md5&#x27;</span>)</span><br><span class="line">    .update(<span class="string">&#x27;&#x27;</span> + v)</span><br><span class="line">    .digest(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  md5</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ›å»º jwtAuth.js æ–‡ä»¶ï¼Œç”¨äº jwt-token éªŒè¯å’Œè§£æå‡½æ•°<br>ä»£ç å¦‚ä¸‹</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> expressJwt = <span class="built_in">require</span>(<span class="string">&#x27;express-jwt&#x27;</span>) <span class="comment">// å¼•å…¥express-jwtæ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> &#123; PRIVATE_KEY &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./constant&#x27;</span>) <span class="comment">// å¼•å…¥è‡ªå®šä¹‰çš„jwtå¯†é’¥</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// éªŒè¯tokenæ˜¯å¦è¿‡æœŸ</span></span><br><span class="line"><span class="keyword">const</span> jwtAuth = expressJwt(&#123;</span><br><span class="line">  <span class="comment">// è®¾ç½®å¯†é’¥</span></span><br><span class="line">  secret: PRIVATE_KEY,</span><br><span class="line">  <span class="comment">// è®¾ç½®ä¸ºtrueè¡¨ç¤ºæ ¡éªŒï¼Œfalseè¡¨ç¤ºä¸æ ¡éªŒ</span></span><br><span class="line">  credentialsRequired: <span class="literal">true</span>,</span><br><span class="line">  algorithms: [<span class="string">&#x27;HS256&#x27;</span>],</span><br><span class="line">  <span class="comment">// è‡ªå®šä¹‰è·å–tokençš„å‡½æ•°</span></span><br><span class="line">  getToken: <span class="function">(<span class="params">req</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(req.headers[<span class="string">&#x27;access-token&#x27;</span>])</span><br><span class="line">    <span class="keyword">if</span> (req.headers[<span class="string">&#x27;access-token&#x27;</span>]) &#123;</span><br><span class="line">      <span class="keyword">return</span> req.headers[<span class="string">&#x27;access-token&#x27;</span>]</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (req.query &amp;&amp; req.query.token) &#123;</span><br><span class="line">      <span class="keyword">return</span> req.query.token</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// è®¾ç½®jwtè®¤è¯ç™½åå•ï¼Œæ¯”å¦‚/api/user/loginç™»å½•æ¥å£ä¸éœ€è¦æ‹¦æˆª</span></span><br><span class="line">&#125;).unless(&#123;</span><br><span class="line">  path: [<span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;/api/user/login&#x27;</span>, <span class="string">&#x27;/api/user/register&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  jwtAuth</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>è·¯ç”±æ§åˆ¶å±‚ï¼ˆRoutesï¼‰</strong><br>åˆ›å»º index.js æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.Router()</span><br><span class="line"><span class="keyword">const</span> userRouter = <span class="built_in">require</span>(<span class="string">&#x27;./users&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> taskRouter = <span class="built_in">require</span>(<span class="string">&#x27;./tasks&#x27;</span>)</span><br><span class="line"></span><br><span class="line">router.use(<span class="string">&#x27;/api/user&#x27;</span>, userRouter)</span><br><span class="line">router.use(<span class="string">&#x27;/api/task&#x27;</span>, taskRouter)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router</span><br></pre></td></tr></table></figure>

<p>åˆ›å»º users.js æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.Router()</span><br><span class="line"><span class="keyword">const</span> &#123; userController &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../controllers&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; checkSchema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;express-validator&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rules = &#123;</span><br><span class="line">  loginValidator: checkSchema(&#123;</span><br><span class="line">    username: &#123;</span><br><span class="line">      isLength: &#123;</span><br><span class="line">        errorMessage: <span class="string">&#x27;usernameé•¿åº¦è‡³å°‘5ä½&#x27;</span>,</span><br><span class="line">        options: &#123; <span class="attr">min</span>: <span class="number">5</span> &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    password: &#123;</span><br><span class="line">      isLength: &#123;</span><br><span class="line">        errorMessage: <span class="string">&#x27;passwordé•¿åº¦è‡³å°‘5ä½&#x27;</span>,</span><br><span class="line">        options: &#123; <span class="attr">min</span>: <span class="number">5</span> &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç™»å½•</span></span><br><span class="line">router.post(<span class="string">&#x27;/login&#x27;</span>, rules.loginValidator, userController.login)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å†Œ</span></span><br><span class="line">router.post(<span class="string">&#x27;/register&#x27;</span>, rules.loginValidator, userController.register)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>åˆ›å»º tasks.js æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹</strong></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.Router()</span><br><span class="line"><span class="keyword">const</span> &#123; taskController &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../controllers&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»»åŠ¡åˆ—è¡¨</span></span><br><span class="line">router.post(<span class="string">&#x27;/list&#x27;</span>, taskController.getTaskList)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»»åŠ¡æ·»åŠ </span></span><br><span class="line">router.post(<span class="string">&#x27;/add&#x27;</span>, taskController.addTask)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»»åŠ¡ç¼–è¾‘</span></span><br><span class="line">router.post(<span class="string">&#x27;/update&#x27;</span>, taskController.updateTask)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»»åŠ¡åˆ é™¤</span></span><br><span class="line">router.get(<span class="string">&#x27;/delete&#x27;</span>, taskController.deleteTask)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>ä¸šåŠ¡é€»è¾‘å±‚ï¼ˆControllersï¼‰</strong><br>åœ¨å†™ä¸šåŠ¡é€»è¾‘å±‚ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹ï¼Œsql è¯­å¥çš„ä¸€äº›è¿”å›å€¼ æ•°æ®åº“æ“ä½œ( CURD)</p>
<p>åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»º controlles æ–‡ä»¶å¤¹</p>
<p>åˆ›å»º index.js æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> userController = <span class="built_in">require</span>(<span class="string">&#x27;./users&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> taskController = <span class="built_in">require</span>(<span class="string">&#x27;./tasks&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  userController,</span><br><span class="line">  taskController</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ›å»º users.js æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; validationResult &#125; = <span class="built_in">require</span>(<span class="string">&#x27;express-validator&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; querySql &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../db/mysql&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; md5 &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../utils/crypto&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; PRIVATE_KEY, JWT_EXPIRED &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../utils/constant&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; getErrorRes, getSuccessRes &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../utils/resHandler&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="function"><span class="title">login</span>(<span class="params">req, res, next</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> err = validationResult(req)</span><br><span class="line">    <span class="keyword">if</span> (!err.isEmpty()) &#123;</span><br><span class="line">      <span class="keyword">const</span> [&#123; msg &#125;] = err.errors</span><br><span class="line">      res.json(getErrorRes(&#123; <span class="attr">message</span>: msg &#125;))</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> &#123; username, password &#125; = req.body</span><br><span class="line">      password = md5(password)</span><br><span class="line">      <span class="keyword">const</span> sql = <span class="string">`select * from sys_user where username=&#x27;<span class="subst">$&#123;username&#125;</span>&#x27; and password=&#x27;<span class="subst">$&#123;password&#125;</span>&#x27;`</span></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> findRes = <span class="keyword">await</span> querySql(sql)</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;--æŸ¥è¯¢ç™»å½•è´¦å·æ•°æ®--&#x27;</span>, findRes)</span><br><span class="line">        <span class="keyword">if</span> (findRes.length === <span class="number">0</span>) &#123;</span><br><span class="line">          res.json(getErrorRes(&#123; <span class="attr">message</span>: <span class="string">&#x27;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&#x27;</span> &#125;))</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// ç™»å½•æˆåŠŸï¼Œç­¾å‘ä¸€ä¸ªtokenå¹¶è¿”å›ç»™å‰ç«¯</span></span><br><span class="line">          <span class="keyword">const</span> token = jwt.sign(</span><br><span class="line">            <span class="comment">// payloadï¼šç­¾å‘çš„ token é‡Œé¢è¦åŒ…å«çš„ä¸€äº›æ•°æ®ã€‚</span></span><br><span class="line">            &#123; username &#125;,</span><br><span class="line">            <span class="comment">// ç§é’¥</span></span><br><span class="line">            PRIVATE_KEY,</span><br><span class="line">            &#123; <span class="attr">algorithm</span>: <span class="string">&#x27;HS256&#x27;</span>, <span class="attr">expiresIn</span>: JWT_EXPIRED &#125;</span><br><span class="line">          )</span><br><span class="line">          <span class="keyword">let</span> userData = &#123;</span><br><span class="line">            id: findRes[<span class="number">0</span>].id,</span><br><span class="line">            username: findRes[<span class="number">0</span>].username,</span><br><span class="line">            nickname: findRes[<span class="number">0</span>].nickname</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">const</span> result = getSuccessRes(&#123;</span><br><span class="line">            message: <span class="string">&#x27;ç™»å½•æˆåŠŸ&#x27;</span>,</span><br><span class="line">            data: &#123;</span><br><span class="line">              token,</span><br><span class="line">              userData</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">          res.json(result)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="keyword">return</span> next(&#123; <span class="attr">message</span>: error &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="function"><span class="title">register</span>(<span class="params">req, res, next</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> err = validationResult(req)</span><br><span class="line">    <span class="keyword">if</span> (!err.isEmpty()) &#123;</span><br><span class="line">      <span class="keyword">const</span> [&#123; msg &#125;] = err.errors</span><br><span class="line">      res.json(getErrorRes(&#123; <span class="attr">message</span>: msg &#125;))</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> &#123; username, password &#125; = req.body</span><br><span class="line">      <span class="keyword">const</span> sql = <span class="string">`select id, username from sys_user where username=&#x27;<span class="subst">$&#123;username&#125;</span>&#x27;`</span></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> findRes = <span class="keyword">await</span> querySql(sql)</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;--æŸ¥è¯¢ç”¨æˆ·æ˜¯å¦å·²å­˜åœ¨--&#x27;</span>, findRes)</span><br><span class="line">        <span class="keyword">if</span> (findRes &amp;&amp; findRes.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">          res.json(getErrorRes(&#123; <span class="attr">message</span>: <span class="string">&#x27;ç”¨æˆ·å·²å­˜åœ¨&#x27;</span> &#125;))</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          password = md5(password)</span><br><span class="line">          <span class="keyword">const</span> sql = <span class="string">`insert into sys_user(username, password, gmt_create, gmt_modify) values(&#x27;<span class="subst">$&#123;username&#125;</span>&#x27;, &#x27;<span class="subst">$&#123;password&#125;</span>&#x27;, &#x27;<span class="subst">$&#123;<span class="keyword">new</span> <span class="built_in">Date</span>().getTime()&#125;</span>&#x27;, &#x27;<span class="subst">$&#123;<span class="keyword">new</span> <span class="built_in">Date</span>().getTime()&#125;</span>&#x27;)`</span></span><br><span class="line">          <span class="keyword">const</span> insertRes = <span class="keyword">await</span> querySql(sql)</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">&#x27;--æ³¨å†Œç”¨æˆ·--&#x27;</span>, insertRes)</span><br><span class="line">          res.json(getSuccessRes(&#123; <span class="attr">message</span>: <span class="string">&#x27;æ³¨å†ŒæˆåŠŸ&#x27;</span> &#125;))</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="keyword">return</span> next(&#123; <span class="attr">message</span>: error &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="keyword">new</span> UserController()</span><br></pre></td></tr></table></figure>

<p>åˆ›å»º tasks.js æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; querySql &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../db/mysql&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; validationResult &#125; = <span class="built_in">require</span>(<span class="string">&#x27;express-validator&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; getErrorRes, getSuccessRes &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../utils/resHandler&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TaskController</span> </span>&#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="function"><span class="title">getTaskList</span>(<span class="params">req, res, next</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> err = validationResult(req)</span><br><span class="line">    <span class="keyword">if</span> (!err.isEmpty()) &#123;</span><br><span class="line">      <span class="keyword">const</span> [&#123; msg &#125;] = err.errors</span><br><span class="line">      res.json(getErrorRes(&#123; <span class="attr">message</span>: msg &#125;))</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> &#123; pageNum, pageSize = <span class="number">10</span> &#125; = req.body</span><br><span class="line">      <span class="keyword">let</span> query = <span class="string">`select d.id, d.title, d.description, d.status, d.gmt_create, d.gmt_expire from sys_task d where status != &#x27;2&#x27;`</span></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> findRes = <span class="keyword">await</span> querySql(query)</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;--æŸ¥è¯¢ä»»åŠ¡åˆ—è¡¨--&#x27;</span>, findRes)</span><br><span class="line">        <span class="keyword">let</span> isLimit = findRes.length &gt; pageSize</span><br><span class="line">        <span class="keyword">let</span> limitRes = []</span><br><span class="line">        <span class="keyword">if</span> (isLimit) &#123;</span><br><span class="line">          <span class="keyword">let</span> n = (pageNum - <span class="number">1</span>) * pageSize</span><br><span class="line">          limitRes = <span class="keyword">await</span> querySql(query + <span class="string">` limit <span class="subst">$&#123;n&#125;</span> , <span class="subst">$&#123;pageSize&#125;</span>`</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        res.json(</span><br><span class="line">          getSuccessRes(&#123;</span><br><span class="line">            message: <span class="string">&#x27;æŸ¥è¯¢æ•°æ®æˆåŠŸ&#x27;</span>,</span><br><span class="line">            data: &#123;</span><br><span class="line">              total: findRes.length,</span><br><span class="line">              list: isLimit ? limitRes : findRes,</span><br><span class="line">              pageNum,</span><br><span class="line">              pageSize</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="keyword">return</span> next(&#123; <span class="attr">message</span>: error &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="function"><span class="title">addTask</span>(<span class="params">req, res, next</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> err = validationResult(req)</span><br><span class="line">    <span class="keyword">if</span> (!err.isEmpty()) &#123;</span><br><span class="line">      <span class="keyword">const</span> [&#123; msg &#125;] = err.errors</span><br><span class="line">      res.json(getErrorRes(&#123; <span class="attr">message</span>: msg &#125;))</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> &#123; title, description, gmt_expire &#125; = req.body</span><br><span class="line">      <span class="keyword">const</span> sql = <span class="string">`select id, title from sys_task where title=&#x27;<span class="subst">$&#123;title&#125;</span>&#x27; and status != 2`</span></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> findRes = <span class="keyword">await</span> querySql(sql)</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;--addTaskå…ˆæŸ¥æ‰¾åŒåä»»åŠ¡--&#x27;</span>, findRes)</span><br><span class="line">        <span class="keyword">if</span> (findRes &amp;&amp; findRes.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">          res.json(getErrorRes(&#123; <span class="attr">message</span>: <span class="string">&#x27;ä»»åŠ¡å·²å­˜åœ¨&#x27;</span> &#125;))</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">const</span> sql = <span class="string">`insert into sys_task(title, description, gmt_create, gmt_expire) values(&#x27;<span class="subst">$&#123;title&#125;</span>&#x27;, &#x27;<span class="subst">$&#123;description&#125;</span>&#x27;, &#x27;<span class="subst">$&#123;<span class="keyword">new</span> <span class="built_in">Date</span>().getTime()&#125;</span>&#x27;, <span class="subst">$&#123;gmt_expire&#125;</span>)`</span></span><br><span class="line">          <span class="keyword">let</span> insertRes = <span class="keyword">await</span> querySql(sql)</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">&#x27;--æ·»åŠ taskæ•°æ®--&#x27;</span>, insertRes)</span><br><span class="line">          res.json(getSuccessRes(&#123; <span class="attr">message</span>: <span class="string">&#x27;æ·»åŠ æ•°æ®æˆåŠŸ&#x27;</span> &#125;))</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="keyword">return</span> next(&#123; <span class="attr">message</span>: error &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="function"><span class="title">updateTask</span>(<span class="params">req, res, next</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> err = validationResult(req)</span><br><span class="line">    <span class="comment">// å¦‚æœéªŒè¯é”™è¯¯ï¼Œemptyä¸ä¸ºç©º</span></span><br><span class="line">    <span class="keyword">if</span> (!err.isEmpty()) &#123;</span><br><span class="line">      <span class="keyword">const</span> [&#123; msg &#125;] = err.errors</span><br><span class="line">      res.json(getErrorRes(&#123; <span class="attr">message</span>: msg &#125;))</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> &#123; id, title, description, status, gmt_expire &#125; = req.body</span><br><span class="line">      <span class="keyword">const</span> sql = <span class="string">`select id, title from sys_task where id != <span class="subst">$&#123;id&#125;</span> and title=&#x27;<span class="subst">$&#123;title&#125;</span>&#x27; and status != 2 `</span></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> findRes = <span class="keyword">await</span> querySql(sql)</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;--æŸ¥è¯¢ä¸ç­‰äºå½“å‰idçš„ä»»åŠ¡æ˜¯å¦å­˜åœ¨--&#x27;</span>, findRes)</span><br><span class="line">        <span class="keyword">if</span> (findRes &amp;&amp; findRes.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">          res.json(getErrorRes(&#123; <span class="attr">message</span>: <span class="string">&#x27;ä»»åŠ¡å·²å­˜åœ¨&#x27;</span> &#125;))</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">const</span> sql = <span class="string">`update sys_task set title=&#x27;<span class="subst">$&#123;title&#125;</span>&#x27;, description=&#x27;<span class="subst">$&#123;description&#125;</span>&#x27;,status=&#x27;<span class="subst">$&#123;status&#125;</span>&#x27;, gmt_expire=&#x27;<span class="subst">$&#123;gmt_expire&#125;</span>&#x27; where id=&#x27;<span class="subst">$&#123;id&#125;</span>&#x27;`</span></span><br><span class="line">          <span class="keyword">let</span> updateRes = <span class="keyword">await</span> querySql(sql)</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">`--æ›´æ–°å½“å‰<span class="subst">$&#123;id&#125;</span>çš„ä»»åŠ¡æ•°æ®--`</span>, updateRes)</span><br><span class="line">          <span class="keyword">if</span> (updateRes &amp;&amp; updateRes.affectedRows &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            res.json(getSuccessRes(&#123; <span class="attr">message</span>: <span class="string">&#x27;æ›´æ–°æ•°æ®æˆåŠŸ&#x27;</span> &#125;))</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            res.json(getErrorRes(&#123; <span class="attr">message</span>: <span class="string">&#x27;æ›´æ–°æ•°æ®å¤±è´¥&#x27;</span> &#125;))</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="keyword">return</span> next(&#123; <span class="attr">message</span>: error &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="function"><span class="title">deleteTask</span>(<span class="params">req, res, next</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> err = validationResult(req)</span><br><span class="line">    <span class="keyword">if</span> (!err.isEmpty()) &#123;</span><br><span class="line">      <span class="keyword">const</span> [&#123; msg &#125;] = err.errors</span><br><span class="line">      res.json(getErrorRes(&#123; <span class="attr">message</span>: msg &#125;))</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> &#123; id, status &#125; = req.query</span><br><span class="line">      <span class="keyword">const</span> sql = <span class="string">`update sys_task set status=&#x27;<span class="subst">$&#123;status&#125;</span>&#x27; where id=&#x27;<span class="subst">$&#123;id&#125;</span>&#x27;`</span></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> deleteRes = <span class="keyword">await</span> querySql(sql)</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`--åˆ é™¤<span class="subst">$&#123;id&#125;</span>çš„ä»»åŠ¡æ•°æ®--`</span>, deleteRes)</span><br><span class="line">        <span class="keyword">if</span> (deleteRes &amp;&amp; deleteRes.affectedRows &gt; <span class="number">0</span>) &#123;</span><br><span class="line">          res.json(getSuccessRes(&#123; <span class="attr">message</span>: <span class="string">&#x27;åˆ é™¤æ•°æ®æˆåŠŸ&#x27;</span> &#125;))</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          res.json(getErrorRes(&#123; <span class="attr">message</span>: <span class="string">&#x27;åˆ é™¤æ•°æ®å¤±è´¥&#x27;</span> &#125;))</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="keyword">return</span> next(&#123; <span class="attr">message</span>: error &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="keyword">new</span> TaskController()</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>å…¥å£æ–‡ä»¶é…ç½®</strong><br>åœ¨æ ¹ç›®å½• app.js ç¨‹åºå…¥å£æ–‡ä»¶ä¸­ï¼Œå¯¼å…¥ Express æ¨¡å—ï¼Œå†å¼•å…¥å¸¸ç”¨çš„ä¸­é—´ä»¶å’Œè‡ªå®šä¹‰ routes è·¯ç”±çš„ä¸­é—´ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> createError = <span class="built_in">require</span>(<span class="string">&#x27;http-errors&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> cookieParser = <span class="built_in">require</span>(<span class="string">&#x27;cookie-parser&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> logger = <span class="built_in">require</span>(<span class="string">&#x27;morgan&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; getErrorRes &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./utils/resHandler&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> routes = <span class="built_in">require</span>(<span class="string">&#x27;./routes/index&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = express()</span><br><span class="line"></span><br><span class="line">app.use(logger(<span class="string">&#x27;dev&#x27;</span>))</span><br><span class="line">app.use(express.json())</span><br><span class="line">app.use(express.urlencoded(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;))</span><br><span class="line">app.use(cookieParser())</span><br><span class="line"></span><br><span class="line">app.use(<span class="string">&#x27;/&#x27;</span>, routes)</span><br><span class="line"></span><br><span class="line"><span class="comment">// catch 404 and forward to error handler</span></span><br><span class="line">app.use(<span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">  next(createError(<span class="number">404</span>))</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// error handler</span></span><br><span class="line">app.use(<span class="function"><span class="keyword">function</span> (<span class="params">err, req, res, next</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// set locals, only providing error in development</span></span><br><span class="line">  res.locals.message = err.message</span><br><span class="line">  res.locals.error = req.app.get(<span class="string">&#x27;env&#x27;</span>) === <span class="string">&#x27;development&#x27;</span> ? err : &#123;&#125;</span><br><span class="line">  res.status(err.status || <span class="number">500</span>)</span><br><span class="line">  <span class="keyword">if</span> (err.status == <span class="number">401</span>) &#123;</span><br><span class="line">    res.json(getErrorRes(&#123; <span class="attr">message</span>: <span class="string">&#x27;ç”¨æˆ·æœªç™»å½•&#x27;</span> &#125;))</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.json(getErrorRes(&#123; <span class="attr">message</span>: err.message || <span class="string">&#x27;æœåŠ¡å™¨å‡ºé”™&#x27;</span> &#125;))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = app</span><br></pre></td></tr></table></figure>

<p>åˆ°æ­¤åŸºäº Vue + antdv + Express + Node.js + MySQL å®ç°çš„å‰åç«¯åŠŸèƒ½å·²åŸºæœ¬å®Œæˆï¼Œæ­¤ç« èŠ‚æš‚å‘Šä¸€æ®µè½ã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯-BFF"><a href="#ä»€ä¹ˆæ˜¯-BFF" class="headerlink" title="ä»€ä¹ˆæ˜¯ BFF"></a>ä»€ä¹ˆæ˜¯ BFF</h2><p>BFFï¼Œå³ Backends For Frontendsï¼ˆæœåŠ¡äºå‰ç«¯çš„åç«¯ï¼‰ã€‚åœ¨ 2015 å¹´ï¼ŒSam Newman å¯¹æ­¤æå‡ºäº†ï¼ŒPattern: Backends For Frontends ï¼Œå›½å†…ä¹Ÿä¿—ç§°ä¸ºç²˜åˆå±‚ã€‚</p>
<p>åœ¨ BFF ç†å¿µä¸­ï¼Œæœ€é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼š æœåŠ¡è‡ªæ²»ï¼Œè°ä½¿ç”¨è°å¼€å‘ï¼Œå³å®ƒåº”è¯¥ç”±å‰ç«¯åŒå­¦å»ç»´æŠ¤ã€‚</p>
<ul>
<li>æœåŠ¡è‡ªæ²»å‡å°‘äº†æ²Ÿé€šæˆæœ¬ï¼Œå¸¦æ¥äº†çµæ´»å’Œé«˜æ•ˆã€‚</li>
<li>BFF å¹¶ä¸é™åˆ¶å…·ä½“æŠ€æœ¯ï¼Œå›¢é˜Ÿæ ¹æ®è‡ªå·±çš„æŠ€æœ¯æ ˆæ¥é€‰å‹ï¼š Java/Node/PHP/Python/Rubyâ€¦<br>PSï¼šServerless For Frontend</li>
</ul>
<h3 id="ä¸ºä»€ä¹ˆé€‰æ‹©-Node-ä½œä¸ºä¸­é—´å±‚"><a href="#ä¸ºä»€ä¹ˆé€‰æ‹©-Node-ä½œä¸ºä¸­é—´å±‚" class="headerlink" title="ä¸ºä»€ä¹ˆé€‰æ‹© Node ä½œä¸ºä¸­é—´å±‚"></a>ä¸ºä»€ä¹ˆé€‰æ‹© Node ä½œä¸ºä¸­é—´å±‚</h3><p><img src="/images/common/bff.png" alt="network"></p>
<h4 id="ä¸šåŠ¡é©±åŠ¨"><a href="#ä¸šåŠ¡é©±åŠ¨" class="headerlink" title="ä¸šåŠ¡é©±åŠ¨"></a>ä¸šåŠ¡é©±åŠ¨</h4><p>Node æœ‰ä¸ªçªå‡ºçš„ä¼˜åŠ¿ï¼Œä»–çš„å¼€å‘è€…å¯ä»¥æ˜¯å‰ç«¯ï¼Œéƒ½ä¼šå€¾å‘äºé€‰æ‹©ç”Ÿæ€æ›´ä¼˜ï¼Œè¯­æ³•æ›´ç†Ÿæ‚‰çš„ Node.jsã€‚</p>
<p>å‰ç«¯å¯¹äºé¡µé¢æ‰€éœ€è¦çš„æ•°æ®æœ‰æ›´å¥½çš„ç†è§£ï¼Œæ¯ä¸ªé¡µé¢è¦ç”¨åˆ°å“ªäº›æ¥å£ï¼Œæ¯ä¸ªæ¥å£è¦ç”¨åˆ°å“ªäº›å­—æ®µå‰ç«¯æ˜¯æœ€æ¸…æ¥šçš„ã€‚å†åŠ ä¸Šå®é™…ä¸šåŠ¡å¼€å‘ä¸­ï¼Œå‰ç«¯é¡µé¢éœ€æ±‚ç»å¸¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œéœ€è¦ä¿®æ”¹å­—æ®µæˆ–è€…æ•°æ®ç»“æ„ï¼Œæ‰€ä»¥å¯¹æ¥é¡µé¢çš„è¿™éƒ¨åˆ†æ¥å£ç”±å‰ç«¯ç›´æ¥å¼€å‘éå¸¸åˆé€‚ï¼Œå¯ä»¥æ˜¾è‘—çš„å‡å°‘æ²Ÿé€šæˆæœ¬ã€‚</p>
<h4 id="æ¶æ„éœ€è¦"><a href="#æ¶æ„éœ€è¦" class="headerlink" title="æ¶æ„éœ€è¦"></a>æ¶æ„éœ€è¦</h4><p>é¢å‘ç”¨æˆ·çš„æ¥å£ç”± Node ä¸­é—´å±‚è´Ÿè´£ä»¥åï¼ŒçœŸæ­£çš„æœåŠ¡ç«¯å¯ä»¥ä¸“æ³¨äºæä¾›åŸºäºé¢†åŸŸæ¨¡å‹çš„å¯¹å†…æ¥å£ï¼Œåšå¾®æœåŠ¡ã€‚</p>
<p>æ¯”å¦‚å¯ä»¥åŸºäº Goods æ¨¡å‹ï¼Œæä¾›æ‰€æœ‰å•†å“ç›¸å…³çš„æ¥å£ï¼›åŸºäº Users æ¨¡å‹ï¼Œæä¾›æ‰€æœ‰ç”¨æˆ·ç›¸å…³æ¥å£ã€‚å½“ä¸€ä¸ªæ¥å£éœ€è¦å•†å“+ç”¨æˆ·ä¿¡æ¯æ—¶ï¼Œç”± Node åˆ†åˆ«æŸ¥è¯¢ç»„è£…ã€‚ä»æ•´ä½“ä¸šåŠ¡ä»£ç ç»´æŠ¤è§’åº¦æ¥è¯´ï¼Œå˜å¾—æ›´å®¹æ˜“ï¼Œä¸ä¼šå› ä¸ºä¸šåŠ¡å‘å±•ä½¿å¾—æ¯ä¸ªæ¥å£éƒ½å¼‚å¸¸ç¹æ‚ã€‚</p>
<h4 id="æ€§èƒ½æ»¡è¶³"><a href="#æ€§èƒ½æ»¡è¶³" class="headerlink" title="æ€§èƒ½æ»¡è¶³"></a>æ€§èƒ½æ»¡è¶³</h4><p>å¦‚æœä»…ä»…æ˜¯æ¶æ„å±‚é¢çš„éœ€æ±‚ï¼Œéœ€è¦æœ‰ä¸€ä¸ªä¸­é—´å±‚æ¥æ²‰æ·€ä¸šåŠ¡ï¼Œé‚£ç”¨ Javaï¼ŒPHP ä¹Ÿå¯ä»¥åšåˆ°ï¼Œä¸ºä»€ä¹ˆè¯´ Node æ›´é€‚åˆåšå‘¢ï¼Ÿ</p>
<p>å› ä¸º Node å¤©ç”Ÿå¼‚æ­¥ï¼</p>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œjs æ˜¯ä¸€é—¨å•çº¿ç¨‹è¯­è¨€ï¼Œæ‰€ä»¥ Node åœ¨å®ç°çš„æ—¶å€™ï¼Œéœ€è¦å€ŸåŠ© libuv æ¥å®ç°å¼‚æ­¥ã€‚libuv ä¸º Node æä¾›äº†çº¿ç¨‹æ± ï¼Œäº‹ä»¶æ± ï¼Œå¼‚æ­¥ I/O ç­‰èƒ½åŠ›ã€‚æ­£æ˜¯å› ä¸ºå…¶ä¸­ç½‘ç»œ I/O çš„å¼‚æ­¥èƒ½åŠ›ï¼Œå¯ä»¥è®© Node åšæ¥å£èšåˆæ—¶ï¼Œèƒ½å¤Ÿæ›´é«˜æ•ˆçš„å¼‚æ­¥å¹¶å‘å¤„ç†ã€‚</p>
<h4 id="æˆæœ¬è¾ƒä½"><a href="#æˆæœ¬è¾ƒä½" class="headerlink" title="æˆæœ¬è¾ƒä½"></a>æˆæœ¬è¾ƒä½</h4><p>Node ä½¿ç”¨ js å¼€å‘ï¼Œåªéœ€è¦å­¦ä¹ ç®€å•çš„ apiï¼Œå‰ç«¯å¼€å‘è€…å°±å¯ä»¥æ— éšœç¢ä½¿ç”¨ï¼Œå­¦ä¹ æˆæœ¬å¾ˆä½ã€‚</p>
<p>è€Œä¸”ï¼ŒNode å…·æœ‰æ´»è·ƒçš„ç¤¾åŒºå’Œä¸°å¯Œçš„æ¨¡å—æ± ï¼Œæ‹¥æœ‰å¾ˆå¤šç°æˆçš„åŠŸèƒ½å®ç°ã€‚æ¡†æ¶æ–¹é¢ï¼Œä¹Ÿæœ‰æˆç†Ÿçš„ koaï¼Œexpress ç­‰åŸºæœ¬æ¡†æ¶å’Œ egg ç­‰äºŒæ¬¡å°è£…æ¡†æ¶ï¼Œå¯æ ¹æ®éœ€æ±‚é€‰æ‹©ä¸Šæ‰‹ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿ã€‚</p>
<p><strong>ä¸­é—´å±‚èƒ½ä¸ºæˆ‘ä»¬åšäº›ä»€ä¹ˆï¼Ÿ</strong><br><img src="/images/common/bff-1.jpeg" alt="network"></p>
<ul>
<li>ä»£ç†ï¼šåœ¨å¼€å‘ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä»£ç†æ¥ï¼Œè§£å†³æœ€å¸¸è§çš„è·¨åŸŸé—®é¢˜ï¼›åœ¨çº¿ä¸Šç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä»£ç†ï¼Œè½¬å‘è¯·æ±‚åˆ°å¤šä¸ªæœåŠ¡ç«¯ã€‚</li>
<li>ç¼“å­˜ï¼šç¼“å­˜å…¶å®æ˜¯æ›´é è¿‘å‰ç«¯çš„éœ€æ±‚ï¼Œç”¨æˆ·çš„åŠ¨ä½œè§¦å‘æ•°æ®çš„æ›´æ–°ï¼Œnode ä¸­é—´å±‚å¯ä»¥ç›´æ¥å¤„ç†ä¸€éƒ¨åˆ†ç¼“å­˜éœ€æ±‚ã€‚</li>
<li>é™æµï¼šnode ä¸­é—´å±‚ï¼Œå¯ä»¥é’ˆå¯¹æ¥å£æˆ–è€…è·¯ç”±åšå“åº”çš„é™æµã€‚</li>
<li>æ—¥å¿—ï¼šç›¸æ¯”å…¶ä»–æœåŠ¡ç«¯è¯­è¨€ï¼Œnode ä¸­é—´å±‚çš„æ—¥å¿—è®°å½•ï¼Œèƒ½æ›´æ–¹ä¾¿å¿«æ·çš„å®šä½é—®é¢˜ï¼ˆæ˜¯åœ¨æµè§ˆå™¨ç«¯è¿˜æ˜¯æœåŠ¡ç«¯ï¼‰ã€‚</li>
<li>ç›‘æ§ï¼šæ“…é•¿é«˜å¹¶å‘çš„è¯·æ±‚å¤„ç†ï¼Œåšç›‘æ§ä¹Ÿæ˜¯åˆé€‚çš„é€‰é¡¹ã€‚</li>
<li>é‰´æƒï¼šæœ‰ä¸€ä¸ªä¸­é—´å±‚å»é‰´æƒï¼Œä¹Ÿæ˜¯ä¸€ç§å•ä¸€èŒè´£çš„å®ç°ã€‚</li>
<li>è·¯ç”±ï¼šå‰ç«¯æ›´éœ€è¦æŒæ¡é¡µé¢è·¯ç”±çš„æƒé™å’Œé€»è¾‘ã€‚</li>
<li><strong>æœåŠ¡ç«¯æ¸²æŸ“ï¼š</strong>node ä¸­é—´å±‚çš„è§£å†³æ–¹æ¡ˆæ›´çµæ´»ï¼Œæ¯”å¦‚ SSRã€æ¨¡æ¿ç›´å‡ºã€åˆ©ç”¨ä¸€äº› JS åº“åšé¢„æ¸²æŸ“ç­‰ç­‰ã€‚<br>æ›´å¤šçš„å¯èƒ½æ€§</li>
</ul>
<p><strong>ä¸­é—´å±‚ä¸šåŠ¡æ¥å£å®è·µæ€è·¯</strong><br>éæ ‡å‡†ï¼Œåªæ˜¯ä¸€ç§å‚è€ƒ<br><img src="/images/common/bff-2.jpeg" alt="network"></p>

      
    </div>
    
    
    

    

    
      <div class="post-share">åˆ†äº«åˆ°ï¼š</div>
    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;display:none;">
  <div></div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>èµèµ</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <picture><source srcset="/images/wechatpay.webp" type="image/webp"><img loading="lazy" id="wechat_qr" src="/images/wechatpay.png" alt=" å¾®ä¿¡æ‰«ä¸€æ‰«ï¼Œå‘æˆ‘èµèµ"/></picture>
        <p>å¾®ä¿¡æ‰«ä¸€æ‰«ï¼Œå‘æˆ‘èµèµ</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <picture><source srcset="/images/alipay.webp" type="image/webp"><img loading="lazy" id="alipay_qr" src="/images/alipay.png" alt=" æ”¯ä»˜å®æ‰«ä¸€æ‰«ï¼Œå‘æˆ‘èµèµ"/></picture>
        <p>æ”¯ä»˜å®æ‰«ä¸€æ‰«ï¼Œå‘æˆ‘èµèµ</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/%E5%A0%86%E4%B8%8E%E6%A0%88/" rel="next" title="å †ä¸æ ˆ">
                <i class="fas fa-angle-left"></i> å †ä¸æ ˆ
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/%E8%BF%90%E8%90%A5%E5%95%86%E5%8A%AB%E6%8C%81/" rel="prev" title="è¿è¥å•†åŠ«æŒ">
                è¿è¥å•†åŠ«æŒ <i class="fas fa-angle-right"></i>
              </a>
            
          </div>
        </div>
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  





  




	





  





  













        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            å…³äºæˆ‘
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
                <audio src="https://cdn.jsdelivr.net/gh/colorfulWorld/cdn-bed@1.3/music/langlangqintian.mp3"  controls="controls" style="width:100%;height:35px;"></audio>
            
            
              <img class="site-author-image" itemprop="image"
                src="https://cdn.jsdelivr.net/gh/colorfulWorld/cdn-bed@1.3/images/gihubpage-1.jpg"
                alt="" />
            
              <p class="site-author-name" itemprop="name"><span style="opacity:.2;">å‘å¾®çš„</span>æ‰“å·¥ä»”</p>
              <p class="site-description motion-element" itemprop="description">ç‘œè€…ï¼Ÿæ„‰è€…ã€æ„šè€…</p>
          </div>

          <div class="links-of-author motion-element">
            
          </div>

          <div class="des-of-author">
              <div class="des-of-author-nav">
                
                  
                    <div class="des-of-author-title active" data-index="1">ç½—æ›¼Â·ç½—å…°</div>
                  
                
                  
                    <div class="des-of-author-title" data-index="2">æ‘ä¸Šæ˜¥æ ‘</div>
                  
                
                  
                    <div class="des-of-author-title" data-index="3">å®«å´éª</div>
                  
                
                  
                    <div class="des-of-author-title" data-index="4">é“å¾·ç»</div>
                  
                
              </div>
              <div class="des-of-author-panel">
                
                  
                    <div class="des-of-author-des active" data-index="1">ä¸–ç•Œä¸Šåªæœ‰ä¸€ç§çœŸæ­£çš„è‹±é›„ä¸»ä¹‰ï¼Œå°±æ˜¯è®¤æ¸…äº†ç”Ÿæ´»çš„çœŸç›¸åè¿˜ä¾ç„¶çƒ­çˆ±å®ƒã€‚</div>
                  
                
                  
                    <div class="des-of-author-des" data-index="2">ä½ è¦å¬è¯ï¼Œä¸æ˜¯æ‰€æœ‰çš„é±¼éƒ½ä¼šç”Ÿæ´»åœ¨åŒä¸€ç‰‡æµ·é‡Œã€‚</div>
                  
                
                  
                    <div class="des-of-author-des" data-index="3">å³ä½¿ä¸èˆï¼Œä¹Ÿè¯¥å¿ƒå­˜æ„Ÿæ¿€ï¼Œç„¶åæŒ¥æ‰‹é“åˆ«ã€‚</div>
                  
                
                  
                    <div class="des-of-author-des" data-index="4">çŸ¥ç™½å®ˆé»‘ å’Œå…‰åŒå°˜</div>
                  
                
              </div>
          </div>

          <details class="views-top-wrap" style="display:none;">
            <summary class="views-top-name scaleup">çœ‹çˆ† Top5</summary>
            <ul class="views-top"></ul>
          </details>

   

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Node-js-%E6%98%AF%E4%BB%80%E4%B9%88"><span class="nav-number">1.</span> <span class="nav-text">Node.js æ˜¯ä»€ä¹ˆ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Node-js-%E4%BC%98%E5%8A%BF"><span class="nav-number">2.</span> <span class="nav-text">Node.js ä¼˜åŠ¿</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Node-js-%E7%89%B9%E7%82%B9"><span class="nav-number">3.</span> <span class="nav-text">Node.js ç‰¹ç‚¹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Node-js-%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B"><span class="nav-number">4.</span> <span class="nav-text">Node.js åº”ç”¨å®ä¾‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Express-%E7%AE%80%E4%BB%8B"><span class="nav-number">5.</span> <span class="nav-text">Express ç®€ä»‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Node-%E7%AE%80%E5%8D%95%E7%9A%84-api-%E7%BC%96%E5%86%99"><span class="nav-number">6.</span> <span class="nav-text">Node ç®€å•çš„ api ç¼–å†™</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">6.1.</span> <span class="nav-text">å‰è¨€</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%8D%E7%AB%AF%E9%83%A8%E5%88%86"><span class="nav-number">6.2.</span> <span class="nav-text">å‰ç«¯éƒ¨åˆ†</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="nav-number">6.2.1.</span> <span class="nav-text">ç›®å½•ç»“æ„</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL-%E4%B8%8E-Navicat"><span class="nav-number">6.3.</span> <span class="nav-text">MySQL ä¸ Navicat</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E9%83%A8%E5%88%86"><span class="nav-number">6.3.1.</span> <span class="nav-text">æ•°æ®åº“è®¾è®¡éƒ¨åˆ†</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8E%E7%AB%AF%E9%83%A8%E5%88%86"><span class="nav-number">6.4.</span> <span class="nav-text">åç«¯éƒ¨åˆ†</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84-1"><span class="nav-number">6.4.1.</span> <span class="nav-text">ç›®å½•ç»“æ„</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8A%80%E6%9C%AF%E6%A0%88"><span class="nav-number">6.4.2.</span> <span class="nav-text">æŠ€æœ¯æ ˆ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97"><span class="nav-number">6.4.3.</span> <span class="nav-text">åŠŸèƒ½æ¨¡å—</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="nav-number">6.4.4.</span> <span class="nav-text">ä»£ç å®ç°</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-BFF"><span class="nav-number">7.</span> <span class="nav-text">ä»€ä¹ˆæ˜¯ BFF</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%80%89%E6%8B%A9-Node-%E4%BD%9C%E4%B8%BA%E4%B8%AD%E9%97%B4%E5%B1%82"><span class="nav-number">7.1.</span> <span class="nav-text">ä¸ºä»€ä¹ˆé€‰æ‹© Node ä½œä¸ºä¸­é—´å±‚</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%9A%E5%8A%A1%E9%A9%B1%E5%8A%A8"><span class="nav-number">7.1.1.</span> <span class="nav-text">ä¸šåŠ¡é©±åŠ¨</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%B6%E6%9E%84%E9%9C%80%E8%A6%81"><span class="nav-number">7.1.2.</span> <span class="nav-text">æ¶æ„éœ€è¦</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%A7%E8%83%BD%E6%BB%A1%E8%B6%B3"><span class="nav-number">7.1.3.</span> <span class="nav-text">æ€§èƒ½æ»¡è¶³</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%88%90%E6%9C%AC%E8%BE%83%E4%BD%8E"><span class="nav-number">7.1.4.</span> <span class="nav-text">æˆæœ¬è¾ƒä½</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-image">

        <img src="https://cdn.jsdelivr.net/gh/colorfulWorld/cdn-bed@1.3/images/footer.png" alt="network">
      </div>
      <div class="footer-inner">
        <p>åšå®¢å·²èŒèŒå“’è¿è¡Œ<span id="since"></span><span class="my-face">(â—'â—¡'â—)ï¾‰â™¥</span></p>


<p>Â© <span itemprop="copyrightYear">2021</span> ColorfulWorld.
    ç”± <a href="https://hexo.io/" target="_blank" class="external" rel="nofollow">Hexo</a> å¼ºåŠ›é©±åŠ¨.
    Theme By <a href="https://github.com/DIYgod/hexo-theme-sagiri" target="_blank" class="external" rel="nofollow">Sagiri</a> v0.0.74.
    <a href="/sitemap.xml" target="_blank">ç«™ç‚¹åœ°å›¾</a>.
</p>
<p>Made with <i class="fas fa-heart throb" style="color: #d43f57;"></i> by <span class="author" itemprop="copyrightHolder">ColorfulWorld</span>. </p>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <img src="https://cdn.jsdelivr.net/gh/colorfulWorld/cdn-bed/images/scroll.png" alt="network">
        
      </div>
    

    <canvas id="evanyou"></canvas>

    

  </div>

  <script type="text/javascript" src="/js/sagiri.min.js?v=0.0.74"></script>

  





  

  
  

  

  

  


  <!--<script>
    // remove service worker cache
    // from https://stackoverflow.com/questions/33704791/how-do-i-uninstall-a-service-worker
    "use strict";
    if(navigator.serviceWorker)
    {
        navigator.serviceWorker.getRegistrations().then(function(registrations) {
            for(let registration of registrations) {
                registration.unregister()
            }
        })
    }
  </script>-->

  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js');
      });
    }
  </script>
</body>
</html>
